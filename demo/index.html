<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>ImgCacher</title>
    </head>
    <body>
        <script type="text/javascript" src="./img-cacher.js"></script>
        <script type="text/javascript">
            var url = 'http://www.marketingjs.com/assets/car.jpg',
                imgCacher = new window.ImgCacher({
                    prefix: 'img-demo-',
                    logging: 'imgCacher'
                }),
                img;

            for (var i = 5 - 1; i >= 0; i--) {
                img = document.createElement('img');

                imgCacher.src('car', {
                    // r: Math.random(), // Just so that we can test stuff :)
                    cropWidth: (i * 10) + 22,
                    cropHeight: (i * 10) + 22,
                    fillWidth: (i * 10) + 22,
                    fillHeight: (i * 10) + 22,
                    buildSrc: function(done) {
                        setTimeout(function() {
                            done(url);
                        }, 3000);
                    }
                    // bg: 'red',
                    // cropX: 0,
                    // cropY: 0,
                    // maxHeight: 100,
                    // maxWidth: 100,
                }, function(err, dataUrl, isNetworkRequest) {
                    var content = '';

                    if (err) { // Something went wrong! Fallback to the supplied `url`.
                        content += 'Something went wrong â€“ falling back to HTTP URL.';
                        img.src = url;
                    } else {
                        content += '`src` is Data URL.';
                        img.src = dataUrl;
                    }

                    document.body.appendChild(document.createElement('hr'));
                    document.body.innerHTML += content + '<br>';
                    document.body.appendChild(img);
                });
            }
        </script>
    </body>
</html>
